---
- message: all go files
  when:
    builtin.file: "*.go"
- message: POM XML dependencies
  when:
    builtin.xml: "//dependencies/dependency"
- message: POM XML dependencies
  when:
    chain:
    - builtin.file: pom.xml
      as: poms
    - builtin.xml:
        xpath: "//dependencies/dependency"
        filepaths: '{{ index .poms "filepaths" }}'
      from: poms
- message: POM XML dependencies testing
  when:
    chain:
    - or:
      - chain:
        - builtin.file: pom.xml
          as: poms
        - builtin.filecontent: TODO(\(.*\))?:?(.*)?
      - builtin.xml:
          xpath: "//dependencies/dependency"
          filepaths: '{{ index .poms "filepaths" }}'
        from: poms
- message: Find all TODOs
  when:
    builtin.filecontent: TODO(\(.*\))?:?(.*)?
- message: find all providerSpecificConfig
  when:
    builtin.json:
      xpath: "//providerSpecificConfig/*"
- message: apiextensions/v1beta1/customresourcedefinitions is deprecated, apiextensions/v1/customresourcedefinitions
    should be used instead
  when:
    or:
    - java.referenced: "*CustomResourceDefinition*"
    - go.referenced: "*CustomResourceDefinition*"
- message: testing one condition
  when:
    go.referenced: "*CustomResourceDefinition*"
- message: testing nested conditions
  when:
    or:
    - and:
      - go.referenced: "*CustomResourceDefinition*"
      - java.referenced: "*CustomResourceDefinition*"
    - go.referenced: "*CustomResourceDefinition*"
- message: testing java condition
  when:
    java.referenced: "*apiextensions.v1beta1.CustomResourceDefinition*"
